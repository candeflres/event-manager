<section *ngIf="!loading" class="event-detail">
  <header class="event-header">
    <h1>{{ event.name }}</h1>

    <div class="event-meta">
      <span class="meta-item">ðŸ“… {{ event.eventDate }}</span>
      <span class="meta-item">estado: {{ event.status }}</span>
      <span class="meta-item"> presupuesto: ${{ event.estimatedBudget }}</span>
    </div>
  </header>

  <!-- VISUALIZACIÃ“N -->
  <section *ngIf="!editMode" class="event-view">
    <p class="description">{{ event.description }}</p>

    <div class="options-list">
      <h3>Opciones elegidas</h3>
      <ul>
        <li *ngFor="let o of event.options">
          <span>{{ o.name }}</span>
          <strong>${{ o.price }}</strong>
        </li>
      </ul>
    </div>
  </section>

  <!-- EDICIÃ“N CLIENTE -->
  <section *ngIf="editMode && isClient" class="event-edit">
    <h3>Editar evento</h3>

    <input [(ngModel)]="editForm.name" placeholder="Nombre" />
    <textarea [(ngModel)]="editForm.description" placeholder="DescripciÃ³n"></textarea>
    <input type="date" [(ngModel)]="editForm.eventDate" />

    <div class="elements">
      <div class="element" *ngFor="let el of elements">
        <h4>{{ el.name }}</h4>

        <label *ngFor="let opt of el.options">
          <input
            type="radio"
            [name]="'element-' + el.id"
            [checked]="selectedOptionIds.includes(opt.id)"
            (change)="selectOption(el.id, opt.id)"
          />
          {{ opt.name }} â€” ${{ opt.price }}
        </label>
      </div>
    </div>

    <div class="budget-box">
      Presupuesto estimado
      <strong>${{ estimatedBudget }}</strong>
    </div>

    <button class="primary" (click)="saveChanges()" [disabled]="isSubmitting">
      <span *ngIf="!isSubmitting">Guardar cambios</span>
      <span *ngIf="isSubmitting" class="loading"> <span class="spinner"></span> Guardandoâ€¦ </span>
    </button>
  </section>

  <!-- ACCIONES -->
  <footer class="event-actions">
    <div class="actions-left">
      <button class="ghost" (click)="goBack()">Volver</button>

      <button
        *ngIf="isClient && event.status !== 'COMPLETED'"
        class="danger"
        (click)="cancelEvent()"
        [disabled]="isSubmitting"
      >
        <span *ngIf="!isSubmitting">Cancelar evento</span>
        <span *ngIf="isSubmitting" class="loading">
          <span class="spinner"></span>
          Cancelandoâ€¦
        </span>
      </button>
    </div>

    <div class="actions-right">
      <button *ngIf="isClient && !editMode && canEdit()" class="secondary" (click)="enableEdit()">
        Editar
      </button>

      <button class="share" [routerLink]="['/event', event.id]">Compartir evento</button>
    </div>
  </footer>
</section>
