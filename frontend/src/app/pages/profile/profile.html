<div class="profile-container" *ngIf="!loading && user">
  <h2>Mi perfil</h2>

  <!-- ===================== -->
  <!-- ====== VISTA ======= -->
  <!-- ===================== -->
  <div class="profile-card" *ngIf="!editMode">
    <div class="row">
      <span>Nombre</span>
      <strong>{{ user.firstName }}</strong>
    </div>

    <div class="row">
      <span>Apellido</span>
      <strong>{{ user.lastName }}</strong>
    </div>

    <div class="row">
      <span>Email</span>
      <strong>{{ user.email }}</strong>
    </div>

    <div class="row">
      <span>Teléfono</span>
      <strong>{{ user.phone || '-' }}</strong>
    </div>

    <div class="row" *ngIf="canSeeUserRole">
      <span>Rol</span>
      <strong>{{ user.role }}</strong>
    </div>

    <div class="row">
      <span>Cuenta creada</span>
      <strong>{{ user.created | date: 'dd/MM/yyyy' }}</strong>
    </div>
  </div>

  <!-- ===================== -->
  <!-- ===== EDICIÓN ====== -->
  <!-- ===================== -->
  <div class="profile-card edit-card" *ngIf="editMode">
    <h3>Datos personales</h3>

    <input type="text" placeholder="Nombre" [(ngModel)]="profileForm.firstName" />

    <input type="text" placeholder="Apellido" [(ngModel)]="profileForm.lastName" />

    <input type="email" placeholder="Email" [(ngModel)]="profileForm.email" />

    <input type="text" placeholder="Teléfono" [(ngModel)]="profileForm.phone" />

    <div class="edit-actions">
      <button class="save-btn" (click)="saveProfile()">Guardar cambios</button>
    </div>

    <!-- ===== CAMBIO PASSWORD ===== -->
    <h3 class="password-title">Cambiar contraseña</h3>

    <input
      type="password"
      placeholder="Contraseña actual"
      [(ngModel)]="passwordForm.currentPassword"
    />

    <input type="password" placeholder="Nueva contraseña" [(ngModel)]="passwordForm.newPassword" />

    <button class="password-btn" (click)="changePassword()">Cambiar contraseña</button>
  </div>

  <!-- ===================== -->
  <!-- ===== WARNINGS ===== -->
  <!-- ===================== -->
  <div class="inactive-warning" *ngIf="!user.active">Esta cuenta se encuentra dada de baja</div>

  <!-- ===================== -->
  <!-- ===== ACCIONES ===== -->
  <!-- ===================== -->
  <div class="profile-actions">
    <button class="back-btn" (click)="handleBack()">Volver</button>

    <button
      class="edit-btn"
      *ngIf="!editMode && user.role !== 'ADMIN' && user.active"
      (click)="enableEdit()"
    >
      Editar perfil
    </button>

    <button class="delete-btn" *ngIf="isClientUser && user.active" (click)="deleteMyAccount()">
      Quiero borrar mi cuenta
    </button>
  </div>
</div>
